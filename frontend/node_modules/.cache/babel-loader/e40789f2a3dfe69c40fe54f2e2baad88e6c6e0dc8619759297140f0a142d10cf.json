{"ast":null,"code":"//import router from '@/router';\nimport axios from 'axios';\nexport default {\n  name: \"ManageUsersComponent\",\n  data() {\n    return {\n      emailID: \"\",\n      roleID: \"\",\n      myFile: '',\n      username: \"\",\n      usernames: [],\n      user_id: null\n    };\n  },\n  methods: {\n    async onDelete(x) {\n      x.preventDefault();\n      await axios.get(\"/api/user\").then(res => {\n        let data = res.data.data;\n        this.usernames = data.map(({\n          user_name\n        }) => user_name);\n        if (!this.usernames.includes(this.username)) {\n          alert(\"This username doesn't exist or is an admin/manager.\");\n          this.$router.go();\n        } else {\n          data.forEach(x => {\n            if (x.user_name == this.username) {\n              this.user_id = x.user_id;\n              console.log(this.user_id);\n            }\n          });\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n      await axios.delete(`/api/user/${this.user_id}`).then(() => {\n        alert(\"User deleted successfully\");\n        this.$router.go();\n      }).catch(err => {\n        console.log(err);\n      });\n    },\n    async addUser(x) {\n      // console.log(this.response)\n      x.preventDefault();\n      let thing = null;\n      if (this.roleID.toLowerCase() == \"student\") {\n        thing = 1;\n      } else if (this.roleID.toLowerCase() == \"admin\") {\n        thing = 3;\n      } else if (this.roleID.toLowerCase() == \"support agent\") {\n        thing = 2;\n      } else if (this.roleID.toLowerCase() == \"manager\") {\n        thing = 4;\n      } else {\n        alert(\"Please choose role amongst student/admin/manager/support agent!\");\n        this.roleID = \"\";\n      }\n      if (this.roleID == \"\") {\n        location.reload();\n      } else {\n        console.log(this.emailID);\n        console.log(thing);\n        let c = this.emailID;\n        var data = {\n          email_id: c,\n          role_id: thing\n        };\n        console.log(c);\n        data = JSON.stringify(data);\n        console.log(\"Data is :\");\n        console.log(data);\n        await axios.post(\"/api/user\", data).then(res => {\n          alert(\"User has been successfully added.\");\n          this.$router.go();\n          console.log(res);\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n    },\n    onUpload() {\n      this.myFile = this.$refs.file.files[0];\n    },\n    fileSubmission() {\n      let formData = new FormData();\n      console.log(this.myFile);\n      formData.append('file', this.myFile);\n      let authtoken = localStorage.getItem(\"token\");\n      fetch(\"http://localhost:5000/api/importUsers\", {\n        method: 'POST',\n        mode: 'cors',\n        cache: 'no-cache',\n        credentials: 'omit',\n        headers: {\n          'secret_authtoken': authtoken\n          //'Content-Type': \"multipart/form-data\",\n        },\n\n        redirect: 'follow',\n        referrerPolicy: 'no-referrer',\n        body: formData\n      }).then(() => {\n        alert(\"User addition request has been received. You will get notified via email on the status.\"); /*location.reload()*/\n      }).catch(e => console.log(e));\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","emailID","roleID","myFile","username","usernames","user_id","methods","onDelete","x","preventDefault","get","then","res","map","user_name","includes","alert","$router","go","forEach","console","log","catch","err","delete","addUser","thing","toLowerCase","location","reload","c","email_id","role_id","JSON","stringify","post","onUpload","$refs","file","files","fileSubmission","formData","FormData","append","authtoken","localStorage","getItem","fetch","method","mode","cache","credentials","headers","redirect","referrerPolicy","body","e"],"sources":["E:\\IIT MADRAS\\SE_ST\\SE PROJECT\\Project 1\\Intermediate Work\\Code\\frontend\\src\\components\\ManageUsersComponent.vue"],"sourcesContent":["<template>\r\n    <div class=\"container\">\r\n        <div class=\"container\" style=\"margin-top: 20px;\">\r\n            <p>\r\n                <button class=\"btn btn-primary heading\" type=\"button\" data-bs-toggle=\"collapse\"\r\n                    data-bs-target=\"#collapseExample\" aria-expanded=\"false\" aria-controls=\"collapseExample\">\r\n                    ADD A USER BY EMAIL ID\r\n                </button>\r\n            </p>\r\n            <div class=\"collapse\" id=\"collapseExample\">\r\n                <div class=\"card card-body\">\r\n                    <form v-on:submit=\"addUser\">\r\n                        <div class=\"form-group\">\r\n                            <label>Enter Email ID</label>\r\n                            <input type=\"text\" class=\"form-control\" v-model=\"emailID\" required />\r\n                        </div>\r\n                        <br />\r\n                        <div class=\"form-group\"><label>Choose Role</label><select v-model=\"roleID\" class=\"form-select\">\r\n                                <option value=\"student\">Student</option>\r\n                                <option value=\"support agent\">Support Agent</option>\r\n                                <option value=\"admin\">Admin</option>\r\n                                <option value=\"manager\">Manager</option>\r\n                            </select>\r\n                        </div>\r\n                        <button class=\"btn btn-primary\" type=\"submit\">Submit</button>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <hr />\r\n        <div class=\"container\">\r\n            <p>\r\n                <button class=\"btn btn-primary heading\" type=\"button\" data-bs-toggle=\"collapse\"\r\n                    data-bs-target=\"#collapseExample2\" aria-expanded=\"false\" aria-controls=\"collapseExample\">\r\n                    ADD MULTIPLE USERS BY CSV FILE\r\n                </button>\r\n            </p>\r\n            <div class=\"collapse\" id=\"collapseExample2\">\r\n                <div class=\"card card-body\">\r\n                    <label> Please upload a CSV file if you wish to import data</label><br />\r\n                    <div class=\"form-group\"><input class=\"btn btn-lg\" ref=\"file\" id=file type=\"file\" accept=\".csv\"\r\n                            v-on:change=\"onUpload($event)\" /></div>\r\n                    <div class=\"col-md-4\">\r\n                        <button class=\"btn btn-primary\" @click=\"fileSubmission\">Submit</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <hr />\r\n        <div class=\"container\">\r\n            <p>\r\n                <button class=\"btn btn-primary heading\" type=\"button\" data-bs-toggle=\"collapse\"\r\n                    data-bs-target=\"#collapseExample3\" aria-expanded=\"false\" aria-controls=\"collapseExample\">\r\n                    DELETE USER BY USERNAME\r\n                </button>\r\n            </p>\r\n            <div class=\"collapse\" id=\"collapseExample3\">\r\n                <div class=\"card card-body\">\r\n                    <div class=\"form-group\"><label>Enter the username you wish to delete</label><input type=\"text\"\r\n                            class=\"form-control\" v-model=\"username\" required /></div>\r\n                    <div class=\"col-md-4\">\r\n                        <button class=\"btn btn-primary\" type=\"submit\" @click=\"onDelete\">Delete</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\n//import router from '@/router';\r\nimport axios from 'axios';\r\nexport default {\r\n    name: \"ManageUsersComponent\",\r\n    data() {\r\n        return {\r\n            emailID: \"\",\r\n            roleID: \"\",\r\n            myFile: '',\r\n            username: \"\",\r\n            usernames: [],\r\n            user_id: null,\r\n        };\r\n\r\n    },\r\n    methods: {\r\n        async onDelete(x) {\r\n            x.preventDefault();\r\n            await axios.get(\"/api/user\").then((res) => {\r\n                let data = res.data.data;\r\n                this.usernames = data.map(({ user_name }) => user_name)\r\n                if (!this.usernames.includes(this.username)) {\r\n                    alert(\"This username doesn't exist or is an admin/manager.\");\r\n                    this.$router.go();\r\n                }\r\n                else {\r\n                    data.forEach(x => { if (x.user_name == this.username) { this.user_id = x.user_id; console.log(this.user_id) } });\r\n                }\r\n\r\n            }).catch((err) => {\r\n                console.log(err);\r\n            });\r\n            await axios.delete(`/api/user/${this.user_id}`).then(() => { alert(\"User deleted successfully\"); this.$router.go(); }).catch((err) => { console.log(err); })\r\n        },\r\n        async addUser(x) {\r\n            // console.log(this.response)\r\n            x.preventDefault();\r\n            let thing = null;\r\n            if (this.roleID.toLowerCase() == \"student\") {\r\n                thing = 1;\r\n            }\r\n            else if (this.roleID.toLowerCase() == \"admin\") {\r\n                thing = 3;\r\n            }\r\n            else if (this.roleID.toLowerCase() == \"support agent\") {\r\n                thing = 2;\r\n            }\r\n            else if (this.roleID.toLowerCase() == \"manager\") {\r\n                thing = 4;\r\n            }\r\n            else {\r\n                alert(\"Please choose role amongst student/admin/manager/support agent!\")\r\n                this.roleID = \"\";\r\n            }\r\n            if (this.roleID == \"\") {\r\n                location.reload();\r\n            }\r\n            else {\r\n                console.log(this.emailID);\r\n                console.log(thing);\r\n                let c = this.emailID\r\n                var data = { email_id: c, role_id: thing };\r\n                console.log(c);\r\n                data = JSON.stringify(data);\r\n                console.log(\"Data is :\")\r\n                console.log(data);\r\n                await axios.post(\"/api/user\", data).then((res) => {\r\n                    alert(\"User has been successfully added.\")\r\n                    this.$router.go();\r\n                    console.log(res)\r\n                }).catch((err) => {\r\n                    console.log(err);\r\n                });\r\n            }\r\n        },\r\n        onUpload() {\r\n            this.myFile = this.$refs.file.files[0];\r\n\r\n        },\r\n        fileSubmission() {\r\n            let formData = new FormData();\r\n            console.log(this.myFile);\r\n            formData.append('file', this.myFile);\r\n\r\n            let authtoken = localStorage.getItem(\"token\");\r\n            fetch(\"http://localhost:5000/api/importUsers\", {\r\n                method: 'POST',\r\n                mode: 'cors',\r\n                cache: 'no-cache',\r\n                credentials: 'omit',\r\n                headers: {\r\n                    'secret_authtoken': authtoken,\r\n                    //'Content-Type': \"multipart/form-data\",\r\n                },\r\n                redirect: 'follow',\r\n                referrerPolicy: 'no-referrer',\r\n                body: formData\r\n            }).then(() => { alert(\"User addition request has been received. You will get notified via email on the status.\");/*location.reload()*/ }).catch(e => console.log(e));\r\n        },\r\n    }\r\n}\r\n</script>\r\n<style scoped>\r\n.topic-container {\r\n    margin: 33px 63px;\r\n}\r\n\r\n.form-group {\r\n    margin-bottom: 1.5rem;\r\n}\r\n\r\n.heading {\r\n    background-color: white;\r\n    color: black;\r\n    font-size: 25px;\r\n}\r\n\r\n.heading:hover {\r\n    background-color: #f1f1f1;\r\n    color: black;\r\n    font-size: 20px;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}